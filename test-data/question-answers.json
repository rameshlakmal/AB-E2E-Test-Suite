{
  "datasource": {
    "correctanswer": "import pandas as pd\n\nexternal_sales_agg = external_sales.groupby(\"product\", as_index=False)[\"revenue_external\"].sum()\ninternal_sales_agg = internal_sales.groupby(\"product_name\", as_index=False)[\"revenue_internal\"].sum()\n\nsales_merged = product_info.merge(\n    external_sales_agg, left_on=\"product_name\", right_on=\"product\", how=\"left\"\n).merge(\n    internal_sales_agg, left_on=\"product_name\", right_on=\"product_name\", how=\"left\"\n)\n\nsales_merged[\"revenue_external\"].fillna(0, inplace=True)\nsales_merged[\"revenue_internal\"].fillna(0, inplace=True)\n\nfinal_sales_corrected = sales_merged.groupby(\"category\", as_index=False).agg(\n    Total_Internal_Revenue=(\"revenue_internal\", \"sum\"),\n    Total_External_Revenue=(\"revenue_external\", \"sum\")\n)\n\nfinal_sales_corrected[\"Total_Category_Revenue\"] = (\n    final_sales_corrected[\"Total_Internal_Revenue\"] + final_sales_corrected[\"Total_External_Revenue\"]\n)\n\nfinal_sales_corrected = final_sales_corrected.sort_values(by=\"Total_Category_Revenue\", ascending=False)",
    "incorrectanswer": "import pandas as pd\n\nexternal_sales_agg = external_sales.groupby(\"product\", as_index=False)[\"revenue_external\"].sum()\ninternal_sales_agg = internal_sales.groupby(\"product_name\", as_index=False)[\"revenue_internal\"].sum()\n\nsales_merged = product_info.merge(\n    external_sales_agg, left_on=\"product_name\", right_on=\"product\", how=\"left\"\n).merge(\n    internal_sales_agg, left_on=\"product_name\", right_on=\"product_name\", how=\"left\"\n)\n\nsales_merged[\"revenue_external\"].fillna(0, inplace=True)\nsales_merged[\"revenue_internal\"].fillna(0, inplace=True)\n\nfinal_sales_corrected = sales_merged.groupby(\"category\", as_index=False).agg(\n    Total_Internal_Revenue=(\"revenue_internal\", \"sum\"),\n    Total_External_Revenue=(\"revenue_external\", \"sum\")\n)\n\nfina_sales_corrected[\"Total_Category_Revenue\"] = (\n    final_sales_corrected[\"Total_Internal_Revenue\"] + final_sales_corrected[\"Total_External_Revenue\"]\n)\n\nfinal_sales_corrected = final_sales_corrected.sort_values(by=\"Total_Category_Revenue\", ascending=False)"
  }
}
